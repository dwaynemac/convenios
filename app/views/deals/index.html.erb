<ol class="breadcrumb">
  <li><%= link_to t('deals.index.all_deals'), deals_path %></li>
  <%- if @federation -%>
    <span class="divider"> / </span></li><li><%= link_to @federation.name, deals_path(federation_id: @federation.id) %></li>
  <%- end -%>
  <%- if @query -%>
    <span class="divider"> / </span></li><li><%= link_to @query, deals_path(q: @query) %></li>
  <%- end -%>
</ol>

<table class="table table-striped table-responsive">
  <tr>
    <th>#</th>
    <th><%= t('business.attributes.name').capitalize %></th>
    <th><%= t('business.attributes.address').capitalize %></th>
    <th><%= t('deal.attributes.title').capitalize %></th>
    <th><%= t('deal.attributes.description').capitalize %></th>
    <th><%= t('deal.attributes.responsible_user').capitalize %></th>
    <th><%= t('deal.attributes.responsible_account').capitalize %></th>
    <th><%= t('deal.attributes.federation') %></th>
    <th></th>
  </tr>
  <%- @deals.each do |deal| -%>
    <tr>
      <td><%= deal.id %></td>
      <td><%= deal.business.name %></td>
      <td><%= deal.business.address %></td>
      <td><%= deal.title %></td>
      <td><%= deal.description %></td>
      <td><%= deal.responsible_user.gsub('.',' ').titleize %></td>
      <td><%= deal.responsible_account.gsub('.|_',' ').titleize %></td>
      <td><%= deal.cached_federation_name %></td>
      <td>
        <%- if current_user.username == deal.responsible_user -%>
          <%= link_to t('deals.index.cancel_deal'),
                      deal_path(deal.id),
                      method: :delete,
                      confirm: t('deals.index.confirm_destroy'),
                      class: 'btn btn-mini btn-danger' %>
        <%- end -%>
      </td>
    </tr>
  <%- end -%>
</table>
